<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="version" content="3.16.4" />
    <meta name="last-updated" content="2025-09-29" />
    <title>Couchbase Slow Query Analyzer & N1QL Query Optimizer v3.16.4 (Execution Plan Analyzer & Index Advisor)</title>
    <meta name="description" content="Open-source Couchbase slow query analyzer and N1QL query optimizer. Execution plan analyzer, index advisor, profiler, timeline charts, and tuning guide.">
    <meta name="keywords" content="Couchbase query optimizer tool, How to debug Couchbase N1QL queries, Couchbase slow query analyzer, N1QL query performance tuning guide, Couchbase execution plan analyzer, Optimize Couchbase SQL++ queries, Couchbase index advisor tool, Debugging slow Couchbase queries, Couchbase query monitoring dashboard, Tune Couchbase query performance, Couchbase N1QL profiler, Analyze Couchbase completed requests, Couchbase query optimization tips, How to fix slow N1QL queries, Couchbase cost-based optimizer guide, N1QL query execution timeline, Couchbase performance insights tool, Debug Couchbase query errors, Couchbase query tuning best practices, Offline Couchbase query analyzer">
    <link rel="canonical" href="https://cb.fuj.io/en/">
    <meta property="og:title" content="Couchbase Slow Query Analyzer & N1QL Query Optimizer v3.16.3">
    <meta property="og:description" content="Open-source Couchbase slow query analyzer and N1QL query optimizer. Execution plan analyzer, index advisor, profiler, timeline charts, and tuning guide.">
    <meta property="og:url" content="https://cb.fuj.io/en/">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="icon" type="image/svg+xml" href="img/favicon.svg">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f7fa;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        header {
            text-align: center;
            padding: 5px 20px;
            background: linear-gradient(135deg, #007acc 0%, #00b4d8 100%);
            color: white;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        }
        header img.logo {
            max-width: 150px;
            margin-bottom: 20px;
        }
        h1 {
            font-size: 2.5em;
            margin: 0;
            letter-spacing: 0.2px;
        }
        h2 {
            font-size: 1.8em;
            color: #007acc;
            margin-top: 40px;
            position: relative;
        }
        /* Section title accent */
        h2::after {
            content: "";
            display: block;
            width: 56px;
            height: 3px;
            background: #00b4d8;
            border-radius: 2px;
            margin-top: 8px;
        }
        .intro {
            text-align: center;
            font-size: 1.1em;
            max-width: 600px;
            margin: 0 auto 30px;
            color: #4a5568;
        }
        .steps, .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .step, .feature {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #eaeef2;
            box-shadow: 0 4px 14px rgba(0,0,0,0.06);
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }
        .step:hover, .feature:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 24px rgba(0,0,0,0.10);
        }
        .step a {
            display: inline-block;
            padding: 10px 20px;
            background: #007acc;
            color: white;
            border-radius: 6px;
            text-decoration: none;
            margin-top: 10px;
            box-shadow: 0 2px 6px rgba(0,122,204,0.25);
            transition: background 0.2s ease, transform 0.2s ease;
        }
        .step a:hover {
            background: #005f99;
            transform: translateY(-1px);
        }

        /* Hero CTA */
        .cta-btn{
            display:inline-block;
            padding:12px 22px;
            background:#007acc;
            color:#fff;
            border-radius:8px;
            text-decoration:none;
            font-weight:600;
            box-shadow:0 6px 18px rgba(0,122,204,0.25);
            transition:transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        }
        .cta-btn:hover{background:#005f99;transform:translateY(-1px);box-shadow:0 10px 24px rgba(0,122,204,0.3)}

        /* Mini gallery under hero */
        .mini-gallery{display:flex;gap:14px;justify-content:center;align-items:stretch;flex-wrap:wrap;margin:6px 0 18px}
        .mini-card{display:flex;flex-direction:column;align-items:center;background:#fff;border:1px solid #eaeef2;border-radius:10px;box-shadow:0 4px 14px rgba(0,0,0,0.06);padding:8px 10px;width:180px;transition:transform 0.2s ease, box-shadow 0.2s ease}
        .mini-card:hover{transform:translateY(-3px);box-shadow:0 10px 24px rgba(0,0,0,0.10)}
        .mini-card img{width:160px;height:100px;object-fit:cover;border-radius:8px;margin-bottom:6px}
        .mini-card span{font-size:0.95em;color:#2d3748;font-weight:600}

        /* Match original SQL query box + copy button look & feel */
        .sql-query-box{background:#f8f9fa;border:1px solid #dee2e6;border-radius:8px;padding:15px;margin:15px 0;position:relative;box-shadow:0 2px 8px rgba(0,0,0,0.05)}
        .sql-query-box pre{background:#ffffff;border:1px solid #e9ecef;border-radius:6px;padding:10px;margin:10px 0;font-family:monospace;font-size:12px;line-height:1.5;overflow-x:auto}
        .sql-copy-btn{position:absolute;top:10px;right:10px;background:#007bff;color:white;border:none;border-radius:6px;padding:6px 12px;font-size:11px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.12);transition: background 0.2s ease, transform 0.2s ease}
        .sql-copy-btn:hover{background:#0056b3;transform: translateY(-1px)}

        .gallery {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 30px 0;
        }
        .gallery img {
            width: 300px;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            will-change: transform;
        }
        .gallery img:hover {
            transform: scale(1.7);
            box-shadow: 0 14px 30px rgba(0,0,0,0.25);
            position: relative;
            z-index: 2;
        }
        .accordion {
            background: white;
            border-radius: 10px;
            border: 1px solid #eaeef2;
            box-shadow: 0 4px 14px rgba(0,0,0,0.06);
            margin: 20px 0;
        }
        .accordion-header {
            padding: 15px;
            cursor: pointer;
            background: #f0f8ff;
            font-weight: bold;
            border-bottom: 1px solid #e6eef5;
        }
        .accordion-content {
            padding: 0 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }
        .accordion-content.open {
            max-height: 500px;
            padding: 15px;
        }

        /* Floating GitHub icon like the original */
        .floating-github{position:fixed;bottom:10px;right:10px;z-index:999;text-align:center}
        .floating-github img{width:40px;height:40px;filter: drop-shadow(0 2px 6px rgba(0,0,0,0.2))}
        .floating-github .copyright{margin-top:6px;font-size:12px;color:#777}

        /* Version badge (parity with original) */
        .version-info{position:fixed;bottom:10px;left:10px;background:rgba(0,0,0,0.1);color:#333;padding:4px 8px;border-radius:4px;font-size:0.75em;font-family:monospace;z-index:999;opacity:0.7;transition:opacity 0.3s ease}
        .version-info:hover{opacity:1;background:rgba(0,0,0,0.2)}

        footer {
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
            color: #666;
            border-top: 1px solid #eaeef2;
            margin-top: 30px;
        }
        footer a {
            color: #007acc;
            text-decoration: none;
        }
        footer a:hover {
            text-decoration: underline;
        }

        /* Accessible focus styles */
        a:focus-visible, button:focus-visible {
            outline: 3px solid rgba(0,122,204,0.35);
            outline-offset: 2px;
            border-radius: 6px;
        }

        @media (max-width: 600px) {
            body { padding: 10px; }
            h1 { font-size: 2em; }
            .gallery img { width: 100%; max-width: 300px; height: auto; }
        }
    </style>
</head>
<body>
    <!-- Floating GitHub link (matches original positioning/appearance) -->
    <div class="floating-github">
        <a href="https://github.com/Fujio-Turner/cb_completed_request" target="_blank" rel="noopener noreferrer">
            <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub repository for Couchbase slow query analysis tool">
        </a>
        <div class="copyright">Â© 2025 fuj.io</div>
    </div>

    <header>
        <h1>Couchbase Query Analyzer</h1>
        <p>Open-source tool to debug and analyze slow N1QL/SQL++ queries.</p>
    </header>

    <section>
        <h2>Screenshots</h2>
        <div class="gallery">
            <img src="img/dashboard.png" alt="Couchbase Query Analyzer dashboard">
            <img src="img/timeline.png" alt="N1QL query execution timeline charts">
            <img src="img/indexes_queries_flow.png" alt="Index and query flow diagram visualization">
        </div>
    </section>

    <main>
        <section>
            <h2>Why Are My Queries Slow?</h2>
            <p>Slow Couchbase queries can stem from unoptimized N1QL/SQL++ statements, missing indexes, or inefficient data scans. This open-source tool helps you:</p>
            <ul>
                <li>Identify bottlenecks with detailed query analysis.</li>
                <li><b>Insights</b> provides a quick overview and suggestions.</li>
                <li>Visualize query performance with timelines and metrics.</li>
            </ul>
        </section>

        <section>
            <h2>Get Started</h2>
            <div class="steps">
                <div class="step">
                    <strong>1. Extract Data</strong>
                    <p>Run the following query in your Couchbase Query Workbench , Capella Query tab or <code>cbq</code>, then export the results as JSON.</p>
                    <div class="sql-query-box">
                        <pre>SELECT *, meta().plan FROM system:completed_requests ORDER BY requestId LIMIT 2000;</pre>
                        <button class="sql-copy-btn">Copy</button>
                    </div>
                </div>
                <div class="step">
                    <strong>2. Analyze & Optimize</strong>
                    <p><a href="https://cb.fuj.io/en/" target="_blank" rel="noopener noreferrer">Open Analyzer</a> â in the <b>upper-left corner</b>, paste or upload your JSON to get instant analysis and suggestions.</p>
                    <p><b>Private & Secure:</b> <i>Runs entirely in your browser with no server uploads. Optionally download the HTML to run locally.</i></p>

                </div>
                <div class="step">
                    <strong>3. Apply & Test</strong>
                    <p>Implement index or query changes, then re-run to confirm performance gains.</p>
                      <a href="https://cb.fuj.io/analysis_hub" target="_blank" rel="noopener noreferrer" style="color:#ecedee; font-weight:600;">Need help? Analysis Hub</a>
                 
                </div>
            </div>
        </section>


        <section>
            <h2>FAQs</h2>
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">How do I get query data to use for the tool/analyzer?</div>
                <div class="accordion-content">
                    <p>Run the SQL++ query from <strong>1. Extract Data</strong> in Couchbase Query Workbench or Capella Query tab, then export queries as JSON by copying and pasting or saving to a file. For advanced, targeted SQL++ queries to filter JSON results, see <a href="https://cb.fuj.io/sql_queries" target="_blank" rel="noopener noreferrer">Targeted Query Filters</a>.</p>
                    <p>Also see: <a href="sample/test_system_completed_requests.json" target="_blank" rel="noopener noreferrer">Sample (dummy) completed_requests JSON</a></p>
                </div>
            </div>
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">How do I use this tool and/or debug queries?</div>
                <div class="accordion-content">
                    <p>For a step-by-step workflow to analyze your JSON results, interpret metrics, and debug slow queries, visit the <a href="https://cb.fuj.io/analysis_hub" target="_blank" rel="noopener noreferrer">Analysis Hub - Couchbase N1QL Query Optimization Guide & Glossary</a>.</p>
                    <p>Also see: <a href="https://cb.fuj.io/sql_queries" target="_blank" rel="noopener noreferrer">Targeted Query Filters</a> <span style="color:#a0aec0">â¢</span> <a href="sample/test_system_completed_requests.json" target="_blank" rel="noopener noreferrer">Sample (dummy) completed_requests JSON</a></p>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">Where do I paste the JSON in the tool?</div>
                <div class="accordion-content">
                    <p>Open the analyzer and paste or upload your JSON in the <b>upper-left</b> input box, then click <b>Parse JSON</b>. See the placement below:</p>
                    <img src="img/paste_json.png" alt="Paste JSON in the upper-left input box and click Parse JSON" style="max-width: 520px; width: 100%; border: 1px solid #e6eef5; border-radius: 6px; margin: 8px 0;">
                    <p>Also see: <a href="https://cb.fuj.io/en/" target="_blank" rel="noopener noreferrer">Open Analyzer</a></p>
                </div>
            </div>

                        <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">Where does the slow query data come from?</div>
                <div class="accordion-content">
                    <p>The Couchbase cluster stores a small history of queries that take longer then 1 second. You can query/get this history via <code>system:completed_requests</code> catalog. Run the query from <strong>1. Extract Data</strong> in Query Workbench or <code>cbq</code> to collect recent query executions, timing metrics, and the execution plan.</p>
                    <div class="sql-query-box">
<pre>SELECT *, meta().plan FROM system:completed_requests ORDER BY requestId LIMIT 2000;</pre>
                        <button class="sql-copy-btn">Copy</button>
                    </div>
                    <p>NOTE: The above query will not get all of the slow query history but rather a small 2000 sample in random order.</p>
                    <p>Also see: <a href="https://cb.fuj.io/sql_queries" target="_blank" rel="noopener noreferrer">Targeted Query Filters</a> <span style="color:#a0aec0">â¢</span> <a href="sample/test_system_completed_requests.json" target="_blank" rel="noopener noreferrer">Sample (dummy) completed_requests JSON</a></p>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">How large can the JSON be?</div>
                <div class="accordion-content">
                    <p>Typical exports are around <b>9â45 MB</b>. For larger datasets, filter by time range or use <a href="https://cb.fuj.io/sql_queries" target="_blank" rel="noopener noreferrer">Targeted Query Filters</a>.</p>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">Why is the analyzer slow or crashing?</div>
                <div class="accordion-content">
                    <p>Large JSON payloads and browser memory limits can impact performance. Try the following:</p>
                    <ul>
                        <li>Export a smaller dataset (filter by time range or query patterns before exporting).</li>
                        <li>Use the <b>Upload</b> option instead of copy/paste to reduce your browser's memory overhead.</li>
                        <li>Prefer  <img src="img/firefox.png" alt="Firefox" style="width: 20px; height: 20px;"> <b>Firefox</b> â it parses and renders large JSON the fastest.</li>
                    </ul>
                    <p>Also see: <a href="https://cb.fuj.io/sql_queries" target="_blank" rel="noopener noreferrer">Targeted Query Filters</a> <span style="color:#a0aec0">â¢</span> <a href="https://raw.githubusercontent.com/Fujio-Turner/cb_completed_request/main/en/index.html" target="_blank" rel="noopener noreferrer">Download HTML (en/index.html)</a></p>
                </div>
            </div>

            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">Can I use this with Couchbase Capella?</div>
                <div class="accordion-content">
                    <p>Yes, it is fully compatible with both Couchbase Server and Capella. Just Run the same query from <strong>1. Extract Data</strong> in the Query tab in your Capella cluster.</p>
                    <p>Also see: <a href="https://docs.couchbase.com/cloud/" target="_blank" rel="noopener noreferrer">Couchbase Capella documentation</a></p>
                </div>
            </div>
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">How do I get the index definitions from the slow queries?</div>
                <div class="accordion-content">
                    <p>Run the <code>system:indexes</code> query, then paste or upload the JSON into the <b>upper-right</b> input box of the analyzer. This connects index metadata to your slow queries for the Indexes and Index/Query Flow views.</p>
                    <div class="sql-query-box">
<pre>SELECT 
    s.name,
    s.id,
    s.metadata,
    s.state,
    s.num_replica,
    s.`using` AS indexType,
    CONCAT("CREATE INDEX ", s.name, " ON ", k, ks, p, w, ";") AS indexString
FROM system:indexes AS s
LET bid = CONCAT("", s.bucket_id, ""),
    sid = CONCAT("", s.scope_id, ""),
    kid = CONCAT("", s.keyspace_id, ""),
    k = NVL2(bid, CONCAT2(".", bid, sid, kid), kid),
    ks = CASE WHEN s.is_primary THEN "" ELSE "(" || CONCAT2(",", s.index_key) || ")" END,
    w = CASE WHEN s.condition IS NOT NULL THEN " WHERE " || REPLACE(s.condition, '"', "'") ELSE "" END,
    p = CASE WHEN s.`partition` IS NOT NULL THEN " PARTITION BY " || s.`partition` ELSE "" END;</pre>
                        <button class="sql-copy-btn">Copy</button>
                    </div>
                    <p>See also: <a href="https://cb.fuj.io/sql_queries" target="_blank" rel="noopener noreferrer">Targeted Query Filters</a> <span style="color:#a0aec0">â¢</span> <a href="sample/test_system_indexes.json" target="_blank" rel="noopener noreferrer">Sample (dummy) system:indexes JSON</a></p>
                </div>
        </div>
            <div class="accordion">
                <div class="accordion-header" onclick="toggleAccordion(this)">What are the terms of use and license?</div>
                <div class="accordion-content">
                    <p>Apache 2.0 license. Contribute or report issues on <a href="https://github.com/Fujio-Turner/cb_completed_request" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
                    <p>Also see: <a href="https://github.com/Fujio-Turner/cb_completed_request/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">LICENSE</a></p>
                </div>
            </div>

        </section>
    </main>

    <div class="version-info">Couchbase Slow Query Analysis Tool v3.16.4</div>

    <footer>
        <p>&copy; 2025 <a href="https://fuj.io" target="_blank" rel="noopener noreferrer">fuj.io</a>.</p>
    </footer>

    <script>
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            content.classList.toggle('open');
        }

        // Match original Copy behavior (button text + green success color)
        document.querySelectorAll('.sql-copy-btn').forEach(button => {
            button.addEventListener('click', () => {
                const code = button.parentElement.querySelector('pre').textContent;
                navigator.clipboard.writeText(code).then(() => {
                    button.style.background = '#28a745';
                    const prevText = button.textContent;
                    button.textContent = 'Copied!';
                    setTimeout(() => {
                        button.textContent = prevText;
                        button.style.background = '';
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                });
            });
        });
    </script>
</body>
</html>